{
  "AltLookAngle": {
    "x": 0,
    "y": 0,
    "z": 0
  },
  "Autoraise": true,
  "ColorDiffuse": {
    "b": 1,
    "g": 1,
    "r": 1
  },
  "CustomImage": {
    "CustomToken": {
      "MergeDistancePixels": 15,
      "Stackable": false,
      "StandUp": false,
      "Thickness": 0.1
    },
    "ImageScalar": 1,
    "ImageSecondaryURL": "",
    "ImageURL": "http://cloud-3.steamusercontent.com/ugc/1857193769884995506/A760D5A6C66A035C4E4812BF5F0D511010EF526C/",
    "WidthScale": 0
  },
  "Description": "Adds/removes the desired token from the chaos bag.\n\nSee context menu for additional information.",
  "DragSelectable": true,
  "GMNotes": "",
  "GUID": "023240",
  "Grid": true,
  "GridProjection": false,
  "Hands": false,
  "HideWhenFaceDown": false,
  "IgnoreFoW": false,
  "LayoutGroupSortIndex": 0,
  "Locked": false,
  "LuaScript": "-- Chaos Bag Manager\r\n-- made by:         Chr1Z\r\n-- based on:        Bless/Curse Manager\r\n-- description:     for easier managing of the chaos bag (adding / removing tokens)\r\ninformation = {\r\n    version = \"1.3\",\r\n    last_updated = \"10.10.2022\"\r\n}\r\n\r\nlocal TOKEN_URL = {\r\n    ElderSign  = \"https://i.imgur.com/nEmqjmj.png\",\r\n    plusOne    = \"https://i.imgur.com/uIx8jbY.png\",\r\n    Zero       = \"https://i.imgur.com/btEtVfd.png\",\r\n    minusOne   = \"https://i.imgur.com/w3XbrCC.png\",\r\n    minusTwo   = \"https://i.imgur.com/bfTg2hb.png\",\r\n    minusThree = \"https://i.imgur.com/yfs8gHq.png\",\r\n    minusFour  = \"https://i.imgur.com/qrgGQRD.png\",\r\n    minusFive  = \"https://i.imgur.com/3Ym1IeG.png\",\r\n    minusSix   = \"https://i.imgur.com/c9qdSzS.png\",\r\n    minusSeven = \"https://i.imgur.com/4WRD42n.png\",\r\n    minusEight = \"https://i.imgur.com/9t3rPTQ.png\",\r\n    Skull      = \"https://i.imgur.com/stbBxtx.png\",\r\n    Cultist    = \"https://i.imgur.com/VzhJJaH.png\",\r\n    Tablet     = \"https://i.imgur.com/1plY463.png\",\r\n    ElderThing = \"https://i.imgur.com/ttnspKt.png\",\r\n    AutoFail   = \"https://i.imgur.com/lns4fhz.png\",\r\n    Frost      = \"http://cloud-3.steamusercontent.com/ugc/1858293462583104677/195F93C063A8881B805CE2FD4767A9718B27B6AE/\"\r\n}\r\n\r\nlocal TOKEN_NAMES = {\r\n    -- first row\r\n    \"plusOne\", \"Zero\", \"minusOne\", \"minusTwo\", \"minusThree\", \"minusFour\",\r\n    -- second row\r\n    \"minusFive\", \"minusSix\", \"minusSeven\", \"minusEight\", \"Frost\",\r\n    -- third row\r\n    \"ElderSign\", \"Skull\", \"Cultist\", \"Tablet\", \"ElderThing\", \"AutoFail\"\r\n}\r\n\r\nlocal BUTTON_TOOLTIP = {\r\n    -- first row\r\n    \"+1\", \"0\", \"-1\", \"-2\", \"-3\", \"-4\",\r\n    -- second row\r\n    \"-5\", \"-6\", \"-7\", \"-8\", \"Frost\",\r\n    -- third row\r\n    \"Elder Sign\", \"Skull\", \"Cultist\", \"Tablet\", \"Elder Thing\", \"Auto-fail\"\r\n}\r\n\r\ny0 = 0\r\nz1 = -0.778\r\nz2 = 0\r\nz3 = 0.75\r\n\r\nlocal BUTTON_POSITION = {\r\n    -- first row\r\n    { -1.90, y0, z1 },\r\n    { -1.14, y0, z1 },\r\n    { -0.38, y0, z1 },\r\n    { 0.38, y0, z1 },\r\n    { 1.14, y0, z1 },\r\n    { 1.90, y0, z1 },\r\n    -- second row\r\n    { -1.90, y0, z2 },\r\n    { -1.14, y0, z2 },\r\n    { -0.38, y0, z2 },\r\n    { 0.38, y0, z2 },\r\n    { 1.90, y0, z2 },\r\n    -- third row\r\n    { -1.90, y0, z3 },\r\n    { -1.14, y0, z3 },\r\n    { -0.38, y0, z3 },\r\n    { 0.38, y0, z3 },\r\n    { 1.14, y0, z3 },\r\n    { 1.90, y0, z3 },\r\n}\r\n\r\n-- common button parameters\r\nlocal BUTTON_PARAMETERS          = {}\r\nBUTTON_PARAMETERS.function_owner = self\r\nBUTTON_PARAMETERS.color          = { 0, 0, 0, 0 }\r\nBUTTON_PARAMETERS.width          = 300\r\nBUTTON_PARAMETERS.height         = 300\r\n\r\nfunction onload()\r\n    -- create buttons for tokens\r\n    for i = 1, #BUTTON_POSITION do\r\n        BUTTON_PARAMETERS.position       = BUTTON_POSITION[i]\r\n        BUTTON_PARAMETERS.click_function = attachIndex(\"button_click\", i)\r\n        BUTTON_PARAMETERS.tooltip        = BUTTON_TOOLTIP[i]\r\n        self.createButton(BUTTON_PARAMETERS)\r\n    end\r\n\r\n    self.addContextMenuItem(\"More Information\", function()\r\n        printToAll(\"------------------------------\", \"White\")\r\n        printToAll(\"Chaos Bag Manager v\" .. information[\"version\"] .. \" by Chr1Z\", \"Orange\")\r\n        printToAll(\"last updated: \" .. information[\"last_updated\"], \"White\")\r\n    end)\r\nend\r\n\r\n-- get chaos bag from scripting zone and description\r\nfunction getChaosBag()\r\n    local chaosbag = nil\r\n    local chaosbag_zone = getObjectFromGUID(\"83ef06\")\r\n\r\n    -- error handling: scripting zone not found\r\n    if chaosbag_zone == nil then\r\n        printToAll(\"Zone for chaos bag detection couldn't be found.\", \"Red\")\r\n        return nil\r\n    end\r\n\r\n    for _, v in ipairs(chaosbag_zone.getObjects()) do\r\n        if v.getDescription() == \"Chaos Bag\" then\r\n            chaosbag = getObjectFromGUID(v.getGUID())\r\n            break\r\n        end\r\n    end\r\n\r\n    -- error handling: chaos bag not found\r\n    if chaosbag == nil then\r\n        printToAll(\"Chaos bag couldn't be found.\", \"Red\")\r\n    end\r\n    return chaosbag\r\nend\r\n\r\n-- helper function to carry index\r\nfunction attachIndex(click_function, index)\r\n    local fn_name = click_function .. index\r\n    _G[fn_name] = function(obj, player_color, alt_click)\r\n        _G[click_function](obj, player_color, alt_click, index)\r\n    end\r\n    return fn_name\r\nend\r\n\r\n-- click function for buttons\r\nfunction button_click(obj, player_color, alt_click, index)\r\n    chaosbag = getChaosBag()\r\n\r\n    -- error handling: chaos bag not found\r\n    if chaosbag == nil then return end\r\n\r\n    name = BUTTON_TOOLTIP[index]\r\n    tokens = {}\r\n    for i, v in ipairs(chaosbag.getObjects()) do\r\n        if v.name == name then table.insert(tokens, v.guid) end\r\n    end\r\n\r\n    token = TOKEN_NAMES[index]\r\n    if alt_click then\r\n        -- error handling: no matching token found\r\n        if #tokens == 0 then\r\n            printToAll(\"No \" .. name .. \" tokens in the chaos bag.\", \"Yellow\")\r\n            return\r\n        end\r\n\r\n        -- remove token\r\n        chaosbag.takeObject({\r\n            guid = tokens[1],\r\n            position = self.getPosition(),\r\n            smooth = false,\r\n            callback_function = remove_callback\r\n        })\r\n    else\r\n        -- spawn token (only 8 frost tokens allowed)\r\n        if token == \"Frost\" and #tokens == 8 then\r\n            printToAll(\"The maximum of 8 Frost tokens is already in the bag.\", \"Yellow\")\r\n            return\r\n        end\r\n\r\n        local obj = spawnObject({\r\n            type = 'Custom_Tile',\r\n            position = chaosbag.getPosition() + Vector(0, 1, 0),\r\n            rotation = { x = 0, y = 260, z = 0 },\r\n            callback_function = spawn_callback\r\n        })\r\n        obj.setCustomObject({\r\n            type = 2,\r\n            image = TOKEN_URL[token],\r\n            thickness = 0.10\r\n        })\r\n    end\r\nend\r\n\r\nfunction remove_callback(obj)\r\n    printToAll(\"Removing \" .. name .. \" token (in bag: \" .. #tokens - 1 .. \")\", \"White\")\r\n    obj.destruct()\r\nend\r\n\r\nfunction spawn_callback(obj)\r\n    obj.scale { 0.81, 1, 0.81 }\r\n    obj.setName(name)\r\n    printToAll(\"Adding \" .. name .. \" token (in bag: \" .. #tokens + 1 .. \")\", \"White\")\r\nend",
  "LuaScriptState": "{\"Bless\":8,\"Curse\":0}",
  "LuaScript_path": "ChaosBagManager.023240.ttslua",
  "MeasureMovement": false,
  "Name": "Custom_Token",
  "Nickname": "Chaos Bag Manager",
  "Snap": true,
  "Sticky": true,
  "Tags": [
    "displacement_excluded"
  ],
  "Tooltip": true,
  "Transform": {
    "posX": 22.2145634,
    "posY": 5.6514225,
    "posZ": -34.8109665,
    "rotX": 4.42816544,
    "rotY": 269.8285,
    "rotZ": 357.400879,
    "scaleX": 2.5,
    "scaleY": 1,
    "scaleZ": 2.5
  },
  "Value": 0,
  "XmlUI": ""
}